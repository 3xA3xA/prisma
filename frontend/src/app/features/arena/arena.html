<div class="arena-page">
  <div class="arena-page__inner container">

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         HEADER
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="arena-header">
      <div class="arena-header__badge glass">
        <span>‚öîÔ∏è</span>
        <span class="arena-header__badge-text">AI Arena</span>
      </div>
      <h1 class="arena-header__title text-gradient-white">
        –ê—Ä–µ–Ω–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
      </h1>
      <p class="arena-header__sub text-muted">
        –û–¥–∏–Ω –≤–æ–ø—Ä–æ—Å ‚Äî –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç–æ–≤.
        –û—Ü–µ–Ω–∏, –∫–∞–∫–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ª—É—á—à–µ.
      </p>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         –®–ê–ì 1 ‚Äî –í—ã–±–æ—Ä –º–æ–¥–µ–ª–µ–π
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="arena-step glass-strong glass-shimmer">

      <div class="arena-step__header">
        <div class="arena-step__num">1</div>
        <p class="arena-step__title">
          –í—ã–±–µ—Ä–∏ –º–æ–¥–µ–ª–∏ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (–æ—Ç 2 –¥–æ 4)
        </p>
        <span class="arena-step__counter">
          {{ selectedCount() }}/4 –≤—ã–±—Ä–∞–Ω–æ
        </span>
      </div>

      <div class="arena-models-grid">
        @for (m of allModels; track m.id) {
          <button
            class="arena-model-btn"
            [class.arena-model-btn--selected]="isSelected(m.id)"
            (click)="toggleModel(m.id)"
          >
            <div class="arena-model-btn__icon"
                 [ngStyle]="getModelStyle(m.color)">
              {{ isSelected(m.id) ? '‚úì' : m.name[0] }}
            </div>
            <p class="arena-model-btn__name">{{ m.name }}</p>
            <p class="arena-model-btn__company">{{ m.company }}</p>
          </button>
        }
      </div>

    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         –®–ê–ì 2 ‚Äî –ü—Ä–æ–º–ø—Ç
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="arena-step glass-strong glass-shimmer">

      <div class="arena-step__header">
        <div class="arena-step__num">2</div>
        <p class="arena-step__title">–í–≤–µ–¥–∏ —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å</p>
      </div>

      <textarea
        class="arena-prompt glass-input"
        placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û–±—ä—è—Å–Ω–∏ Transformer –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏..."
        rows="4"
        [value]="prompt()"
        (input)="onPromptInput($event)"
      ></textarea>

      <div class="arena-prompt-footer">
        <div class="arena-suggestions">
            @for (s of suggestions; track s) {
            <button class="btn-glass arena-suggestion" (click)="setPrompt(s)">
                {{ s }}
            </button>
            }
        </div>

        <button
            class="btn-primary arena-run-btn"
            [disabled]="!prompt().trim() || loading()"
            (click)="runArena()"
        >
            @if (loading()) {
            <span class="arena-spinner"></span>
            –ó–∞–ø—Ä–æ—Å...
            } @else {
            ‚öîÔ∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞—Ä–µ–Ω—É
            }
        </button>
        </div>
    <!-- –ë–ª–æ–∫ –æ—à–∏–±–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ ‚Äî –ø–æ–¥ –∫–Ω–æ–ø–∫–æ–π -->
    @if (authError()) {
    <div class="arena-auth-error animate-fade-in">
        <svg width="16" height="16" viewBox="0 0 24 24"
            fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/>
        <line x1="12" y1="8"  x2="12"    y2="12"/>
        <line x1="12" y1="16" x2="12.01" y2="16"/>
        </svg>
        <span>–ß—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –∞—Ä–µ–Ω—É, –Ω—É–∂–Ω–æ –≤–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç</span>
        <button class="btn-primary arena-auth-error__btn" (click)="goToLogin()">
        –í–æ–π—Ç–∏ ‚Üí
        </button>
  </div>
}

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         –®–ê–ì 3 ‚Äî –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    @if (loading() || ran()) {
      <div class="arena-results">

        <div class="arena-step__header arena-results__header">
          <div class="arena-step__num">3</div>
          <p class="arena-step__title">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è</p>
          @if (ran()) {
            <span class="arena-step__counter">
              {{ totalVotes() }} –æ—Ü–µ–Ω–æ–∫
            </span>
          }
        </div>

        <!-- –°–∫–µ–ª–µ—Ç–æ–Ω –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ -->
        @if (loading()) {
          <div class="arena-results-grid"
               [class.arena-results-grid--single]="selectedIds().length === 1">
            @for (id of selectedIds(); track id) {
              <div class="arena-result-card glass">
                <div class="arena-result-card__top">
                  <div class="arena-result-card__icon"
                       [ngStyle]="getModelStyle(getModelById(id).color)">
                    {{ getModelById(id).name[0] }}
                  </div>
                  <div>
                    <p class="arena-result-card__name">{{ getModelById(id).name }}</p>
                    <p class="arena-result-card__company">{{ getModelById(id).company }}</p>
                  </div>
                </div>
                <div class="arena-skeleton">
                  <div class="arena-skeleton__line arena-skeleton__line--full"></div>
                  <div class="arena-skeleton__line arena-skeleton__line--80"></div>
                  <div class="arena-skeleton__line arena-skeleton__line--75"></div>
                  <div class="arena-skeleton__line arena-skeleton__line--90"></div>
                </div>
              </div>
            }
          </div>
        }

        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
        @if (ran() && results().length > 0) {
          <div class="arena-results-grid"
               [class.arena-results-grid--single]="results().length === 1">
            @for (r of results(); track r.modelId; let i = $index) {

              <div class="arena-result-card glass-strong glass-shimmer animate-fade-up">

                <!-- –®–∞–ø–∫–∞ -->
                <div class="arena-result-card__top">
                  <div class="arena-result-card__icon"
                       [ngStyle]="getModelStyle(getModelById(r.modelId).color)">
                    {{ getModelById(r.modelId).name[0] }}
                  </div>
                  <div class="arena-result-card__meta">
                    <p class="arena-result-card__name">
                      {{ getModelById(r.modelId).name }}
                    </p>
                    <p class="arena-result-card__company">
                      {{ getModelById(r.modelId).company }}
                    </p>
                  </div>
                  <div class="arena-result-card__pct">
                    <p class="arena-result-card__pct-val">{{ getPct(r.votes) }}%</p>
                    <p class="arena-result-card__pct-label">–≥–æ–ª–æ—Å–æ–≤</p>
                  </div>
                </div>

                <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä -->
                <div class="arena-progress">
                  <div class="arena-progress__fill"
                       [ngStyle]="getProgressStyle(
                         getModelById(r.modelId).color,
                         getPct(r.votes)
                       )">
                  </div>
                </div>

                <!-- –¢–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞ -->
                <p class="arena-result-card__text">{{ r.text }}</p>

                <!-- –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ -->
                <div class="arena-result-card__actions">
                  <button
                    class="arena-vote-btn"
                    [class.arena-vote-btn--liked]="r.liked === true"
                    (click)="vote(i, true)"
                  >
                    üëç –õ—É—á—à–∏–π –æ—Ç–≤–µ—Ç
                  </button>
                  <button
                    class="arena-vote-btn"
                    [class.arena-vote-btn--disliked]="r.liked === false"
                    (click)="vote(i, false)"
                  >
                    üëé –°–ª–∞–±–µ–µ
                  </button>
                  <button
                    class="btn-glass arena-copy-btn"
                    (click)="copyText(r.text)"
                  >
                    üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                  </button>
                </div>

              </div>
            }
          </div>

          <!-- –õ–∏–¥–µ—Ä–±–æ—Ä–¥ -->
          <div class="arena-leaderboard glass">
            <p class="arena-leaderboard__title">üèÜ –†–µ–π—Ç–∏–Ω–≥ —ç—Ç–æ–≥–æ —Ä–∞—É–Ω–¥–∞</p>
            <div class="arena-leaderboard__list">
              @for (r of sortedResults(); track r.modelId; let i = $index) {
                <div class="arena-leaderboard__row">
                  <span class="arena-leaderboard__place">{{ i + 1 }}</span>
                  <span
                    class="arena-leaderboard__dot"
                    [style.background]="getModelById(r.modelId).color"
                  ></span>
                  <span class="arena-leaderboard__name">
                    {{ getModelById(r.modelId).name }}
                  </span>
                  <span class="arena-leaderboard__pct">
                    {{ getPct(r.votes) }}%
                  </span>
                </div>
              }
            </div>
          </div>
        }

      </div>
    }

  </div>
</div>